#!/bin/sh

commit_msg_file="$1"
first_line="$(head -n 1 "$commit_msg_file" | tr -d '\r')"

pattern='^(feat|fix|docs|style|refactor|perf|test|chore|build|ci|revert)(\([^)]+\))?: .+'

if printf '%s' "$first_line" | grep -Eq "$pattern"; then
  exit 0
fi

cat <<'EOF'
Invalid commit message.
Expected Conventional Commits format:
  type(scope): subject

Examples:
  feat: add payment settlement logging
  fix(worker): handle root route
  chore: update dependencies
EOF
exit 1
